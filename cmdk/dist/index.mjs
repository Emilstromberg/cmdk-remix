import{a as oe}from"./chunk-XJATAMEX.mjs";import*as w from"@radix-ui/react-dialog";import*as e from"react";var de='[cmdk-list-sizer=""]',G='[cmdk-group=""]',J='[cmdk-group-items=""]',fe='[cmdk-group-heading=""]',Q='[cmdk-item=""]',ae=`${Q}:not([aria-disabled="true"])`,K="cmdk-item-select",T="data-value",me=(n,a)=>oe(n,a),ce=e.createContext(void 0),D=()=>e.useContext(ce),se=e.createContext(void 0),_=()=>e.useContext(se),F=e.createContext(void 0),ie=e.forwardRef((n,a)=>{let r=e.useRef(null),o=A(()=>{var t;return{search:"",value:n.value??((t=n.defaultValue)==null?void 0:t.toLowerCase())??"",filtered:{count:0,items:new Map,groups:new Set}}}),c=A(()=>new Set),f=A(()=>new Map),u=A(()=>new Map),v=A(()=>new Set),d=X(n),{label:p,children:R,value:m,onValueChange:S,filter:x,shouldFilter:C,...y}=n;console.log("AllItems: ",c);let $=e.useId(),N=e.useId(),E=e.useId(),h=le();P(()=>{if(m!==void 0){let t=m.trim().toLowerCase();o.current.value=t,h(6,Z),g.emit()}},[m]);let g=e.useMemo(()=>({subscribe:t=>(v.current.add(t),()=>v.current.delete(t)),snapshot:()=>o.current,setState:(t,i,s)=>{var l,b,L;if(console.log(`State Update, key: ${t}, value: ${i}, if statement: ${Object.is(o.current[t],i)}`),!Object.is(o.current[t],i)){if(o.current[t]=i,t==="search")U(),W(),h(1,q);else if(t==="value")if(((l=d.current)==null?void 0:l.value)!==void 0){let k=i??"";(L=(b=d.current).onValueChange)==null||L.call(b,k);return}else s||h(5,Z);g.emit()}},emit:()=>{v.current.forEach(t=>t())}}),[]),H=e.useMemo(()=>({value:(t,i)=>{i!==u.current.get(t)&&(u.current.set(t,i),o.current.filtered.items.set(t,Y(i)),h(2,()=>{W(),g.emit()}))},item:(t,i)=>(c.current.add(t),i&&(f.current.has(i)?f.current.get(i).add(t):f.current.set(i,new Set([t]))),h(3,()=>{U(),W(),o.current.value||q(),g.emit()}),()=>{u.current.delete(t),c.current.delete(t),o.current.filtered.items.delete(t);let s=O();h(4,()=>{U(),(s==null?void 0:s.getAttribute("id"))===t&&q(),g.emit()})}),group:t=>(f.current.has(t)||f.current.set(t,new Set),()=>{u.current.delete(t),f.current.delete(t)}),filter:()=>d.current.shouldFilter,label:p||n["aria-label"],commandRef:r,listId:$,inputId:E,labelId:N}),[]);function Y(t){var s;let i=((s=d.current)==null?void 0:s.filter)??me;return t?i(t,o.current.search):0}function W(){if(!r.current||!o.current.search||d.current.shouldFilter===!1)return;let t=o.current.filtered.items,i=[];o.current.filtered.groups.forEach(l=>{let b=f.current.get(l),L=0;b.forEach(k=>{let ue=t.get(k);L=Math.max(ue,L)}),i.push([l,L])});let s=r.current.querySelector(de);V().sort((l,b)=>{let L=l.getAttribute(T),k=b.getAttribute(T);return(t.get(k)??0)-(t.get(L)??0)}).forEach(l=>{let b=l.closest(J);b?b.appendChild(l.parentElement===b?l:l.closest(`${J} > *`)):s.appendChild(l.parentElement===s?l:l.closest(`${J} > *`))}),i.sort((l,b)=>b[1]-l[1]).forEach(l=>{let b=r.current.querySelector(`${G}[${T}="${l[0]}"]`);b==null||b.parentElement.appendChild(b)})}function q(){let t=V().find(s=>!s.ariaDisabled),i=t==null?void 0:t.getAttribute(T);g.setState("value",i||void 0)}function U(){if(!o.current.search||d.current.shouldFilter===!1){o.current.filtered.count=c.current.size;return}o.current.filtered.groups=new Set;let t=0;for(let i of c.current){let s=u.current.get(i),l=Y(s);o.current.filtered.items.set(i,l),l>0&&t++}for(let[i,s]of f.current)for(let l of s)if(o.current.filtered.items.get(l)>0){o.current.filtered.groups.add(i);break}o.current.filtered.count=t}function Z(){var i,s,l;let t=O();t&&(((i=t.parentElement)==null?void 0:i.firstChild)===t&&((l=(s=t.closest(G))==null?void 0:s.querySelector(fe))==null||l.scrollIntoView({block:"nearest"})),t.scrollIntoView({block:"nearest"}))}function O(){var t;return(t=r.current)==null?void 0:t.querySelector(`${Q}[aria-selected="true"]`)}function V(){return Array.from(r.current.querySelectorAll(ae))}function z(t){let s=V()[t];s&&g.setState("value",s.getAttribute(T))}function B(t){var L;let i=O(),s=V(),l=s.findIndex(k=>k===i),b=s[l+t];(L=d.current)!=null&&L.loop&&(b=l+t<0?s[s.length-1]:l+t===s.length?s[0]:s[l+t]),b&&g.setState("value",b.getAttribute(T))}function ee(t){let i=O(),s=i==null?void 0:i.closest(G),l;for(;s&&!l;)s=t>0?xe(s,G):Le(s,G),l=s==null?void 0:s.querySelector(ae);l?g.setState("value",l.getAttribute(T)):B(t)}let te=()=>z(V().length-1),ne=t=>{t.preventDefault(),t.metaKey?te():t.altKey?ee(1):B(1)},re=t=>{t.preventDefault(),t.metaKey?z(0):t.altKey?ee(-1):B(-1)};return e.createElement("div",{ref:I([r,a]),...y,"cmdk-root":"",onKeyDown:t=>{var i;if((i=y.onKeyDown)==null||i.call(y,t),!t.defaultPrevented)switch(t.key){case"n":case"j":{t.ctrlKey&&ne(t);break}case"ArrowDown":{ne(t);break}case"p":case"k":{t.ctrlKey&&re(t);break}case"ArrowUp":{re(t);break}case"Home":{t.preventDefault(),z(0);break}case"End":{t.preventDefault(),te();break}case"Enter":{console.log("In the enter..."),console.log("Current Event: ",t),t.preventDefault();let s=O();if(s){let l=new Event(K);s.dispatchEvent(l)}}}}},e.createElement("label",{"cmdk-label":"",htmlFor:H.inputId,id:H.labelId,style:Me},p),e.createElement(se.Provider,{value:g},e.createElement(ce.Provider,{value:H},R)))}),ge=e.forwardRef((n,a)=>{var h;let r=e.useId(),o=e.useRef(null),c=e.useContext(F),f=D(),u=X(n),v=((h=u.current)==null?void 0:h.forceMount)??(c==null?void 0:c.forceMount);P(()=>f.item(r,c==null?void 0:c.id),[]);let d=j(r,o,[n.value,n.children,o]),p=_(),R=M(g=>g.value&&g.value===d.current),m=M(g=>v||f.filter()===!1?!0:g.search?g.filtered.items.get(r)>0:!0);e.useEffect(()=>{let g=o.current;if(!(!g||n.disabled))return g.addEventListener(K,x),()=>g.removeEventListener(K,x)},[m,n.onSelect,n.disabled]);let S=le();e.useEffect(()=>{R&&(console.log("Current Ref is Selected: ",o.current),console.log("Current Input Ref: ",n.inputRef.current),S(0,()=>o.current.dispatchEvent(new Event("mouseenter"))),S(5,()=>o.current.dispatchEvent(new Event("mouseleave"))))},[R]);function x(){var g,H;C(),(H=(g=u.current).onSelect)==null||H.call(g,d.current),o.current.click()}function C(){p.setState("value",d.current,!0)}if(!m)return null;let{disabled:y,value:$,onSelect:N,...E}=n;return n.CustomAnchorTag?e.createElement(n.CustomAnchorTag,{to:n.href,prefetch:"intent",ref:I([o,a]),id:r,"cmdk-item":"",role:"option","aria-disabled":y||void 0,"aria-selected":R||void 0,"data-disabled":y||void 0,"data-selected":R||void 0,onPointerMove:y?void 0:C,onClick:y?void 0:x,className:E.className,defaultChecked:E.defaultChecked,defaultValue:E.defaultValue,suppressContentEditableWarning:E.suppressContentEditableWarning,suppressHydrationWarning:E.suppressHydrationWarning,accessKey:E.accessKey},n.children):e.createElement("a",{href:n.href,ref:I([o,a]),id:r,"cmdk-item":"",role:"option","aria-disabled":y||void 0,"aria-selected":R||void 0,"data-disabled":y||void 0,"data-selected":R||void 0,onPointerMove:y?void 0:C,onClick:y?void 0:x,className:E.className,defaultChecked:E.defaultChecked,defaultValue:E.defaultValue,suppressContentEditableWarning:E.suppressContentEditableWarning,suppressHydrationWarning:E.suppressHydrationWarning,accessKey:E.accessKey},n.children)}),ve=e.forwardRef((n,a)=>{var E;let r=e.useId(),o=e.useRef(null),c=e.useContext(F),f=D(),u=X(n),v=((E=u.current)==null?void 0:E.forceMount)??(c==null?void 0:c.forceMount);P(()=>f.item(r,c==null?void 0:c.id),[]);let d=j(r,o,[n.value,n.children,o]),p=_(),R=M(h=>h.value&&h.value===d.current),m=M(h=>v||f.filter()===!1?!0:h.search?h.filtered.items.get(r)>0:!0);e.useEffect(()=>{let h=o.current;if(!(!h||n.disabled))return h.addEventListener(K,S),()=>h.removeEventListener(K,S)},[m,n.onSelect,n.disabled]);function S(){var h,g;x(),(g=(h=u.current).onSelect)==null||g.call(h,d.current)}function x(){p.setState("value",d.current,!0)}if(!m)return null;let{disabled:C,value:y,onSelect:$,...N}=n;return e.createElement("div",{ref:I([o,a]),...N,id:r,"cmdk-item":"",role:"option","aria-disabled":C||void 0,"aria-selected":R||void 0,"data-disabled":C||void 0,"data-selected":R||void 0,onPointerMove:C?void 0:x,onClick:C?void 0:S},n.children)}),pe=e.forwardRef((n,a)=>{let{heading:r,children:o,forceMount:c,...f}=n,u=e.useId(),v=e.useRef(null),d=e.useRef(null),p=e.useId(),R=D(),m=M(C=>c||R.filter()===!1?!0:C.search?C.filtered.groups.has(u):!0);P(()=>R.group(u),[]),j(u,v,[n.value,n.heading,d]);let S=e.useMemo(()=>({id:u,forceMount:c}),[c]),x=e.createElement(F.Provider,{value:S},o);return e.createElement("div",{ref:I([v,a]),...f,"cmdk-group":"",role:"presentation",hidden:m?void 0:!0},r&&e.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:p},r),e.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?p:void 0,className:n.customchildclassname},x))}),Re=e.forwardRef((n,a)=>{let{heading:r,children:o,forceMount:c,...f}=n,u=e.useId(),v=e.useRef(null),d=e.useRef(null),p=e.useId(),R=D(),m=M(C=>c||R.filter()===!1?!0:C.search?C.filtered.groups.has(u):!0);P(()=>R.group(u),[]),j(u,v,[n.value,n.heading,d]);let S=e.useMemo(()=>({id:u,forceMount:c}),[c]),x=e.createElement(F.Provider,{value:S},o);return e.createElement("div",{ref:I([v,a]),...f,"cmdk-group":"",role:"presentation",hidden:m?void 0:!0},r&&e.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:p},r),e.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?p:void 0},x))}),he=e.forwardRef((n,a)=>{let{alwaysRender:r,...o}=n,c=e.useRef(null),f=M(u=>!u.search);return!r&&!f?null:e.createElement("div",{ref:I([c,a]),...o,"cmdk-separator":"",role:"separator"})}),be=e.forwardRef((n,a)=>{let{onValueChange:r,loading:o,...c}=n,f=n.value!=null,u=_(),v=M(m=>m.search),d=M(m=>m.value),p=D();console.log("Store Snapshot: ",u.snapshot()),console.log("Search: ",v),console.log("Value: ",d),console.log("Context: ",p),console.log("Props: ",n);let R=e.useMemo(()=>{var S;let m=(S=p.commandRef.current)==null?void 0:S.querySelector(`${Q}[${T}="${d}"]`);return console.log("Selected Item: ",m),m==null?void 0:m.getAttribute("id")},[d,p.commandRef]);return e.useEffect(()=>{console.log("Props Value: ",n.value," loading: ",o),n.value!=null&&(console.log("State Search commencing..."),u.setState("search",n.value))},[n.value,o]),e.createElement("input",{ref:a,...c,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":p.listId,"aria-labelledby":p.labelId,"aria-activedescendant":R,id:p.inputId,type:"text",value:f?n.value:v,onChange:m=>{f||u.setState("search",m.target.value),r==null||r(m.target.value)}})}),Ee=e.forwardRef((n,a)=>{let{children:r,...o}=n,c=e.useRef(null),f=e.useRef(null),u=D();return e.useEffect(()=>{if(f.current&&c.current){let v=f.current,d=c.current,p,R=new ResizeObserver(()=>{p=requestAnimationFrame(()=>{let m=v.offsetHeight;d.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return R.observe(v),()=>{cancelAnimationFrame(p),R.unobserve(v)}}},[]),e.createElement("div",{ref:I([c,a]),...o,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:u.listId,"aria-labelledby":u.inputId},e.createElement("div",{ref:f,"cmdk-list-sizer":""},r))}),Ce=e.forwardRef((n,a)=>{let{open:r,onOpenChange:o,overlayClassName:c,contentClassName:f,container:u,...v}=n;return e.createElement(w.Root,{open:r,onOpenChange:o},e.createElement(w.Portal,{container:u},e.createElement(w.Overlay,{"cmdk-overlay":"",className:c}),e.createElement(w.Content,{"aria-label":n.label,"cmdk-dialog":"",className:f},e.createElement(ie,{ref:a,...v}))))}),Se=e.forwardRef((n,a)=>{let r=e.useRef(!0),o=M(c=>c.filtered.count===0);return e.useEffect(()=>{r.current=!1},[]),r.current||!o?null:e.createElement("div",{ref:a,...n,"cmdk-empty":"",role:"presentation"})}),ye=e.forwardRef((n,a)=>{let{progress:r,children:o,...c}=n;return e.createElement("div",{ref:a,...c,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},e.createElement("div",{"aria-hidden":!0},o))}),Ie=Object.assign(ie,{List:Ee,CustomItem:ge,Item:ve,Input:be,CustomGroup:pe,Group:Re,Separator:he,Dialog:Ce,Empty:Se,Loading:ye});function xe(n,a){let r=n.nextElementSibling;for(;r;){if(r.matches(a))return r;r=r.nextElementSibling}}function Le(n,a){let r=n.previousElementSibling;for(;r;){if(r.matches(a))return r;r=r.previousElementSibling}}function X(n){let a=e.useRef(n);return P(()=>{a.current=n}),a}var P=typeof window>"u"?e.useEffect:e.useLayoutEffect;function A(n){let a=e.useRef();return a.current===void 0&&(a.current=n()),a}function I(n){return a=>{n.forEach(r=>{typeof r=="function"?r(a):r!=null&&(r.current=a)})}}function M(n){let a=_(),r=()=>n(a==null?void 0:a.snapshot());return e.useSyncExternalStore(a==null?void 0:a.subscribe,r,r)}function j(n,a,r){let o=e.useRef(),c=D();return P(()=>{var u;let f=(()=>{var v;for(let d of r){if(typeof d=="string")return d.trim().toLowerCase();if(typeof d=="object"&&"current"in d&&d.current)return(v=d.current.textContent)==null?void 0:v.trim().toLowerCase()}})();c.value(n,f),(u=a.current)==null||u.setAttribute(T,f),o.current=f}),o}var le=()=>{let[n,a]=e.useState(),r=A(()=>new Map);return P(()=>{r.current.forEach(o=>o()),r.current=new Map},[n]),(o,c)=>{r.current.set(o,c),a({})}},Me={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{Ie as Command,Ce as CommandDialog,Se as CommandEmpty,Re as CommandGroup,pe as CommandGroupCustom,be as CommandInput,ve as CommandItem,ge as CommandItemCustom,Ee as CommandList,ye as CommandLoading,ie as CommandRoot,he as CommandSeparator,M as useCommandState};
