import{a as ae}from"./chunk-XJATAMEX.mjs";import*as P from"@radix-ui/react-dialog";import*as e from"react";var fe='[cmdk-list-sizer=""]',K='[cmdk-group=""]',Q='[cmdk-group-items=""]',me='[cmdk-group-heading=""]',X='[cmdk-item=""]',se=`${X}:not([aria-disabled="true"])`,N="cmdk-item-select",I="data-value",ge=(n,a)=>ae(n,a),ce=e.createContext(void 0),H=()=>e.useContext(ce),ie=e.createContext(void 0),F=()=>e.useContext(ie),j=e.createContext(void 0),le=e.forwardRef((n,a)=>{let r=e.useRef(null),o=O(()=>{var t;return{search:"",value:n.value??((t=n.defaultValue)==null?void 0:t.toLowerCase())??"",filtered:{count:0,items:new Map,groups:new Set}}}),s=O(()=>new Set),d=O(()=>new Map),u=O(()=>new Map),g=O(()=>new Set),f=Y(n),{label:p,children:R,value:m,onValueChange:y,filter:x,shouldFilter:C,shouldSort:M,...A}=n;console.log("AllItems: ",s);let _=e.useId(),b=e.useId(),E=e.useId(),v=ue();k(()=>{if(m!==void 0){let t=m.trim().toLowerCase();o.current.value=t,v(6,ee),S.emit()}},[m]);let S=e.useMemo(()=>({subscribe:t=>(g.current.add(t),()=>g.current.delete(t)),snapshot:()=>o.current,setState:(t,i,c)=>{var l,h,L;if(console.log("SetState: ","key: ",t," value: ",i),console.log("If statement: ",Object.is(o.current[t],i)),!Object.is(o.current[t],i)){if(o.current[t]=i,t==="search")U(),q(),v(1,z);else if(t==="value")if(((l=f.current)==null?void 0:l.value)!==void 0){let D=i??"";(L=(h=f.current).onValueChange)==null||L.call(h,D);return}else c||v(5,ee);S.emit()}},emit:()=>{g.current.forEach(t=>t())}}),[]),W=e.useMemo(()=>({value:(t,i)=>{i!==u.current.get(t)&&(u.current.set(t,i),o.current.filtered.items.set(t,Z(i)),v(2,()=>{q(),S.emit()}))},item:(t,i)=>(s.current.add(t),i&&(d.current.has(i)?d.current.get(i).add(t):d.current.set(i,new Set([t]))),v(3,()=>{U(),q(),o.current.value||z(),S.emit()}),()=>{u.current.delete(t),s.current.delete(t),o.current.filtered.items.delete(t);let c=V();v(4,()=>{U(),(c==null?void 0:c.getAttribute("id"))===t&&z(),S.emit()})}),group:t=>(d.current.has(t)||d.current.set(t,new Set),()=>{u.current.delete(t),d.current.delete(t)}),filter:()=>f.current.shouldFilter,label:p||n["aria-label"],commandRef:r,listId:_,inputId:E,labelId:b}),[]);function Z(t){var c;let i=((c=f.current)==null?void 0:c.filter)??ge;return t?i(t,o.current.search):0}function q(){if(console.log("Inside Sort..."),!r.current||!o.current.search||f.current.shouldSort===!1)return;console.log("Continuing sorting ...");let t=o.current.filtered.items,i=[];o.current.filtered.groups.forEach(l=>{let h=d.current.get(l),L=0;h.forEach(D=>{let de=t.get(D);L=Math.max(de,L)}),i.push([l,L])});let c=r.current.querySelector(fe);G().sort((l,h)=>{let L=l.getAttribute(I),D=h.getAttribute(I);return(t.get(D)??0)-(t.get(L)??0)}).forEach(l=>{let h=l.closest(Q);h?h.appendChild(l.parentElement===h?l:l.closest(`${Q} > *`)):c.appendChild(l.parentElement===c?l:l.closest(`${Q} > *`))}),i.sort((l,h)=>h[1]-l[1]).forEach(l=>{let h=r.current.querySelector(`${K}[${I}="${l[0]}"]`);h==null||h.parentElement.appendChild(h)})}function z(){let t=G().find(c=>!c.ariaDisabled),i=t==null?void 0:t.getAttribute(I);console.log("Selecting First Item:"),console.log("item: ",t),console.log("value: ",i),S.setState("value",i||void 0)}function U(){if(!o.current.search||f.current.shouldFilter===!1){o.current.filtered.count=s.current.size;return}o.current.filtered.groups=new Set;let t=0;for(let i of s.current){let c=u.current.get(i),l=Z(c);o.current.filtered.items.set(i,l),l>0&&t++}for(let[i,c]of d.current)for(let l of c)if(o.current.filtered.items.get(l)>0){o.current.filtered.groups.add(i);break}o.current.filtered.count=t}function ee(){var i,c,l;let t=V();t&&(((i=t.parentElement)==null?void 0:i.firstChild)===t&&((l=(c=t.closest(K))==null?void 0:c.querySelector(me))==null||l.scrollIntoView({block:"nearest"})),t.scrollIntoView({block:"nearest"}))}function V(){var t;return(t=r.current)==null?void 0:t.querySelector(`${X}[aria-selected="true"]`)}function G(){return Array.from(r.current.querySelectorAll(se))}function B(t){let c=G()[t];c&&S.setState("value",c.getAttribute(I))}function J(t){var L;let i=V(),c=G(),l=c.findIndex(D=>D===i),h=c[l+t];(L=f.current)!=null&&L.loop&&(h=l+t<0?c[c.length-1]:l+t===c.length?c[0]:c[l+t]),h&&S.setState("value",h.getAttribute(I))}function te(t){let i=V(),c=i==null?void 0:i.closest(K),l;for(;c&&!l;)c=t>0?Le(c,K):Me(c,K),l=c==null?void 0:c.querySelector(se);l?S.setState("value",l.getAttribute(I)):J(t)}let ne=()=>B(G().length-1),re=t=>{t.preventDefault(),t.metaKey?ne():t.altKey?te(1):J(1)},oe=t=>{t.preventDefault(),t.metaKey?B(0):t.altKey?te(-1):J(-1)};return e.createElement("div",{ref:w([r,a]),...A,"cmdk-root":"",onKeyDown:t=>{var i;if((i=A.onKeyDown)==null||i.call(A,t),!t.defaultPrevented)switch(t.key){case"n":case"j":{t.ctrlKey&&re(t);break}case"ArrowDown":{re(t);break}case"p":case"k":{t.ctrlKey&&oe(t);break}case"ArrowUp":{oe(t);break}case"Home":{t.preventDefault(),B(0);break}case"End":{t.preventDefault(),ne();break}case"Enter":{t.preventDefault();let c=V();if(c){let l=new Event(N);c.dispatchEvent(l)}}}}},e.createElement("label",{"cmdk-label":"",htmlFor:W.inputId,id:W.labelId,style:Te},p),e.createElement(ie.Provider,{value:S},e.createElement(ce.Provider,{value:W},R)))}),ve=e.forwardRef((n,a)=>{var E;let r=e.useId(),o=e.useRef(null),s=e.useContext(j),d=H(),u=Y(n),g=((E=u.current)==null?void 0:E.forceMount)??(s==null?void 0:s.forceMount);k(()=>d.item(r,s==null?void 0:s.id),[]);let f=$(r,o,[n.value,n.children,o]),p=F(),R=T(v=>v.value&&v.value===f.current),m=T(v=>g||d.filter()===!1?!0:v.search?v.filtered.items.get(r)>0:!0);e.useEffect(()=>{let v=o.current;if(!(!v||n.disabled))return v.addEventListener(N,x),()=>v.removeEventListener(N,x)},[m,n.onSelect,n.disabled]);let y=ue();e.useEffect(()=>{if(R){console.log("Current Ref is Selected: ",o.current),console.log("Current Input Ref: ",n.inputRef.current);let v=new Event("mouseenter"),S=new Event("mouseleave");y(0,()=>o.current.dispatchEvent(v)),y(5,()=>o.current.dispatchEvent(S))}},[R]);function x(){var v,S;C(),(S=(v=u.current).onSelect)==null||S.call(v,f.current),o.current.click()}function C(){p.setState("value",f.current,!0)}if(!m)return null;let{disabled:M,value:A,onSelect:_,...b}=n;return n.CustomAnchorTag?e.createElement(n.CustomAnchorTag,{to:n.href,prefetch:"intent",ref:w([o,a]),id:r,"cmdk-item":"",role:"option","aria-disabled":M||void 0,"aria-selected":R||void 0,"data-disabled":M||void 0,"data-selected":R||void 0,onPointerMove:M?void 0:C,onClick:M?void 0:x,className:b.className,defaultChecked:b.defaultChecked,defaultValue:b.defaultValue,suppressContentEditableWarning:b.suppressContentEditableWarning,suppressHydrationWarning:b.suppressHydrationWarning,accessKey:b.accessKey},n.children):e.createElement("a",{href:n.href,ref:w([o,a]),id:r,"cmdk-item":"",role:"option","aria-disabled":M||void 0,"aria-selected":R||void 0,"data-disabled":M||void 0,"data-selected":R||void 0,onPointerMove:M?void 0:C,onClick:M?void 0:x,className:b.className,defaultChecked:b.defaultChecked,defaultValue:b.defaultValue,suppressContentEditableWarning:b.suppressContentEditableWarning,suppressHydrationWarning:b.suppressHydrationWarning,accessKey:b.accessKey},n.children)}),pe=e.forwardRef((n,a)=>{var b;let r=e.useId(),o=e.useRef(null),s=e.useContext(j),d=H(),u=Y(n),g=((b=u.current)==null?void 0:b.forceMount)??(s==null?void 0:s.forceMount);k(()=>d.item(r,s==null?void 0:s.id),[]);let f=$(r,o,[n.value,n.children,o]),p=F(),R=T(E=>E.value&&E.value===f.current),m=T(E=>g||d.filter()===!1?!0:E.search?E.filtered.items.get(r)>0:!0);e.useEffect(()=>{let E=o.current;if(!(!E||n.disabled))return E.addEventListener(N,y),()=>E.removeEventListener(N,y)},[m,n.onSelect,n.disabled]);function y(){var E,v;x(),(v=(E=u.current).onSelect)==null||v.call(E,f.current)}function x(){p.setState("value",f.current,!0)}if(!m)return null;let{disabled:C,value:M,onSelect:A,..._}=n;return e.createElement("div",{ref:w([o,a]),..._,id:r,"cmdk-item":"",role:"option","aria-disabled":C||void 0,"aria-selected":R||void 0,"data-disabled":C||void 0,"data-selected":R||void 0,onPointerMove:C?void 0:x,onClick:C?void 0:y},n.children)}),Re=e.forwardRef((n,a)=>{let{heading:r,children:o,forceMount:s,...d}=n,u=e.useId(),g=e.useRef(null),f=e.useRef(null),p=e.useId(),R=H(),m=T(C=>s||R.filter()===!1?!0:C.search?C.filtered.groups.has(u):!0);k(()=>R.group(u),[]),$(u,g,[n.value,n.heading,f]);let y=e.useMemo(()=>({id:u,forceMount:s}),[s]),x=e.createElement(j.Provider,{value:y},o);return e.createElement("div",{ref:w([g,a]),...d,"cmdk-group":"",role:"presentation",hidden:m?void 0:!0},r&&e.createElement("div",{ref:f,"cmdk-group-heading":"","aria-hidden":!0,id:p},r),e.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?p:void 0,className:n.customchildclassname},x))}),he=e.forwardRef((n,a)=>{let{heading:r,children:o,forceMount:s,...d}=n,u=e.useId(),g=e.useRef(null),f=e.useRef(null),p=e.useId(),R=H(),m=T(C=>s||R.filter()===!1?!0:C.search?C.filtered.groups.has(u):!0);k(()=>R.group(u),[]),$(u,g,[n.value,n.heading,f]);let y=e.useMemo(()=>({id:u,forceMount:s}),[s]),x=e.createElement(j.Provider,{value:y},o);return e.createElement("div",{ref:w([g,a]),...d,"cmdk-group":"",role:"presentation",hidden:m?void 0:!0},r&&e.createElement("div",{ref:f,"cmdk-group-heading":"","aria-hidden":!0,id:p},r),e.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?p:void 0},x))}),be=e.forwardRef((n,a)=>{let{alwaysRender:r,...o}=n,s=e.useRef(null),d=T(u=>!u.search);return!r&&!d?null:e.createElement("div",{ref:w([s,a]),...o,"cmdk-separator":"",role:"separator"})}),Ee=e.forwardRef((n,a)=>{let{onValueChange:r,loading:o,...s}=n,d=n.value!=null,u=F(),g=T(m=>m.search),f=T(m=>m.value),p=H();console.log("Store Snapshot: ",u.snapshot().filtered),console.log("Search: ",g),console.log("Context: ",p),console.log("Props: ",n);let R=e.useMemo(()=>{var y;let m=(y=p.commandRef.current)==null?void 0:y.querySelector(`${X}[${I}="${f}"]`);return m==null?void 0:m.getAttribute("id")},[f,p.commandRef]);return e.useEffect(()=>{console.log("Props Value: ",n.value," loading: ",o),n.value!=null&&!o&&(console.log("State Search commencing..."),u.setState("search",n.value))},[n.value,o]),e.createElement("input",{ref:a,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":p.listId,"aria-labelledby":p.labelId,"aria-activedescendant":R,id:p.inputId,type:"text",value:d?n.value:g,onChange:m=>{d||u.setState("search",m.target.value),r==null||r(m.target.value)}})}),Ce=e.forwardRef((n,a)=>{let{children:r,...o}=n,s=e.useRef(null),d=e.useRef(null),u=H();return e.useEffect(()=>{if(d.current&&s.current){let g=d.current,f=s.current,p,R=new ResizeObserver(()=>{p=requestAnimationFrame(()=>{let m=g.offsetHeight;f.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return R.observe(g),()=>{cancelAnimationFrame(p),R.unobserve(g)}}},[]),e.createElement("div",{ref:w([s,a]),...o,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:u.listId,"aria-labelledby":u.inputId},e.createElement("div",{ref:d,"cmdk-list-sizer":""},r))}),Se=e.forwardRef((n,a)=>{let{open:r,onOpenChange:o,overlayClassName:s,contentClassName:d,container:u,...g}=n;return e.createElement(P.Root,{open:r,onOpenChange:o},e.createElement(P.Portal,{container:u},e.createElement(P.Overlay,{"cmdk-overlay":"",className:s}),e.createElement(P.Content,{"aria-label":n.label,"cmdk-dialog":"",className:d},e.createElement(le,{ref:a,...g}))))}),ye=e.forwardRef((n,a)=>{let r=e.useRef(!0),o=T(s=>s.filtered.count===0);return e.useEffect(()=>{r.current=!1},[]),r.current||!o?null:e.createElement("div",{ref:a,...n,"cmdk-empty":"",role:"presentation"})}),xe=e.forwardRef((n,a)=>{let{progress:r,children:o,...s}=n;return e.createElement("div",{ref:a,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},e.createElement("div",{"aria-hidden":!0},o))}),we=Object.assign(le,{List:Ce,CustomItem:ve,Item:pe,Input:Ee,CustomGroup:Re,Group:he,Separator:be,Dialog:Se,Empty:ye,Loading:xe});function Le(n,a){let r=n.nextElementSibling;for(;r;){if(r.matches(a))return r;r=r.nextElementSibling}}function Me(n,a){let r=n.previousElementSibling;for(;r;){if(r.matches(a))return r;r=r.previousElementSibling}}function Y(n){let a=e.useRef(n);return k(()=>{a.current=n}),a}var k=typeof window>"u"?e.useEffect:e.useLayoutEffect;function O(n){let a=e.useRef();return a.current===void 0&&(a.current=n()),a}function w(n){return a=>{n.forEach(r=>{typeof r=="function"?r(a):r!=null&&(r.current=a)})}}function T(n){let a=F(),r=()=>n(a==null?void 0:a.snapshot());return e.useSyncExternalStore(a==null?void 0:a.subscribe,r,r)}function $(n,a,r){let o=e.useRef(),s=H();return k(()=>{var u;let d=(()=>{var g;for(let f of r){if(typeof f=="string")return f.trim().toLowerCase();if(typeof f=="object"&&"current"in f&&f.current)return(g=f.current.textContent)==null?void 0:g.trim().toLowerCase()}})();s.value(n,d),(u=a.current)==null||u.setAttribute(I,d),o.current=d}),o}var ue=()=>{let[n,a]=e.useState(),r=O(()=>new Map);return k(()=>{r.current.forEach(o=>o()),r.current=new Map},[n]),(o,s)=>{r.current.set(o,s),a({})}},Te={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{we as Command,Se as CommandDialog,ye as CommandEmpty,he as CommandGroup,Re as CommandGroupCustom,Ee as CommandInput,pe as CommandItem,ve as CommandItemCustom,Ce as CommandList,xe as CommandLoading,le as CommandRoot,be as CommandSeparator,T as useCommandState};
